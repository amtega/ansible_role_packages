---

dependency:
  name: galaxy
driver:
  name: docker
lint:
  name: yamllint
platforms:
  - name: centos6
    image: centos:6
    groups:
      - molecule_hosts
  - name: centos7
    image: centos:7
    groups:
      - molecule_hosts
  - name: fedora29
    image: fedora:29
    groups:
      - molecule_hosts
      - molecule_hosts_fedora
  - name: fedora30
    image: fedora:30
    groups:
      - molecule_hosts
      - molecule_hosts_fedora
provisioner:
  name: ansible
  config_options:
    defaults:
      callback_whitelist: profile_tasks
      action_plugins: $PWD/action_plugins
  inventory:
    group_vars:
      molecule_hosts:
        ansible_user: root
        package_name: "httpd"

        packages_debug: yes
        packages_load_from_hostvars: yes
        packages_os:
          centos:
            all:
              telnet: present
            6:
              httpd: present
            7:
              - name: "{{ package_name }}"
                state: present
              - tomcat: present
          fedora:
            29:
              httpd: present
              tomcat: present
            30:
              httpd: present
              tomcat: present
              "@Development Tools": present
        packages_python:
          centos:
            6:
              - "pexpect>=3.3": present
              - "gitlab": present
            7:
              "pexpect>=3.3": present
          fedora:
            29:
              - name: "pexpect>=3.3"
                state: present
                pip_extra_args: "--upgrade"
                virtualenv: ~/.ansible_venv
                virtualenv_site_packages: no
            30:
              "pexpect>=3.3": present

        packages_os_extra:
          all:
            all:
              lynx: present
        packages_python_extra:
          centos:
            7:
              lxml: present

      molecule_hosts_fedora:
        ansible_python_interpreter: /usr/bin/python3
  lint:
    name: ansible-lint
verifier:
  name: testinfra
  lint:
    name: flake8
